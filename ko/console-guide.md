## Network > Peering Gateway > 콘솔 사용 가이드

본 문서에서는 콘솔에서 Peering Gateway를 다룰 때 필요한 내용을 기술합니다.<br>

## 피어링

피어링은 서로 다른 두 개의 VPC를 연결하는 기능입니다. 보통의 경우 VPC는 네트워크 영역이 다르기 때문에 서로 통신이 불가능하며, 플로팅 IP를 이용하여 연결할 수 있으나 이는 네트워크 사용량에 따라 추가 과금됩니다. 따라서 두 개의 VPC를 연결하는 기능을 제공하는데 이를 피어링이라 합니다.

> [참고] 피어링은 서로 다른 두 VPC를 연결합니다. 다른 VPC를 건너서 또 다른 VPC로 연결은 지원하지 않습니다. A <-> B <-> C 연결에서 A와 C는 연결되지 않습니다.

* 두 VPC의 IP 주소 영역은 겹치면 사용할 수 없습니다.<br>
IP 주소 영역이 한쪽이 다른 한쪽과 포함관계가 되어서는 안되며, 이런 경우 피어링 생성이 실패합니다.
* 한국 리전을 제외한 나머지 리전에서는 **기본 라우팅 테이블**에 연결되지 않은 서브넷으로는 통신이 불가능합니다.
    * 한국 리전은 피어링을 생성한 후, 피어링한 양쪽 VPC의 라우팅 테이블에 별도의 라우트를 설정해야 통신이 가능합니다.
        * 라우트의 **대상 CIDR**에 상대 VPC의 IP 주소 영역을 입력하고, **게이트웨이** 목록에서 피어링의 이름을 갖는 **PEERING** 항목을 선택하여 라우트를 추가합니다.
        * 라우트를 추가한 라우팅 테이블에 연결된 서브넷으로만 통신이 가능합니다.
        * **기본 라우팅 테이블**이 아닌 라우팅 테이블도 라우트를 추가하면 라우팅 테이블에 연결된 서브넷에서 피어링 통신이 가능합니다.
        * 피어링 생성 시 서브넷이 없는 VPC를 지정하면 피어링은 생성에 실패합니다.

## 리전 간 피어링

리전 간 피어링은 서로 다른 리전에 생성된 두 개의 VPC를 연결하는 기능입니다. 같은 리전의 VPC는 피어링을 이용하여 연결할 수 있으나 리전이 다른 VPC를 연결할 수는 없습니다. 따라서 리전이 다른 두 개의 VPC를 연결하는 기능을 제공하는데 이를 리전 간 피어링이라 합니다.

> [참고] 리전 간 피어링은 서로 다른 리전의 두 VPC를 연결합니다. 다른 VPC를 건너서 또 다른 VPC로 연결하는 것은 지원하지 않습니다. A <-> B <-> C 연결에서 A와 C는 연결되지 않습니다.

* 리전 간 피어링은 한국(평촌) 리전과 한국(판교) 리전의 VPC에서만 이용할 수 있습니다.
* 동일 계정 동일 프로젝트의 두 개의 VPC만 연결이 가능합니다.
* 리전 간 피어링을 생성하면 연결된 다른 리전에서 자동으로 생성됩니다.
* 리전 간 피어링을 삭제하면 연결된 다른 리전에서 자동으로 삭제됩니다.
* 두 VPC의 IP 주소 영역은 겹치면 사용할 수 없습니다.
* 중복된 VPC연결은 생성할 수 없습니다.
* 피어링된 양쪽 VPC의 라우팅 테이블에 별도의 라우트를 설정해야 통신이 가능합니다.
    * 라우트의 **대상 CIDR**에 상대 VPC의 IP 주소 영역을 입력하고, **게이트웨이** 목록에서 리전 간 피어링의 이름을 갖는 **INTER_REGION_PEERING** 항목을 선택해 라우트를 추가합니다.
    * 라우트를 추가한 라우팅 테이블에 연결된 서브넷으로만 통신이 가능합니다.
    * **기본 라우팅 테이블**이 아닌 라우팅 테이블에 라우트를 추가하면 라우팅 테이블에 연결된 서브넷에서 피어링 통신이 가능합니다.
    * 피어링 생성 시 서브넷이 없는 VPC를 지정하면 피어링은 생성에 실패합니다.

### 리전 간 피어링 생성 가이드
1. **Network > Peering Gateway > 리전 간 피어링** 으로 이동 합니다.
2. **리전 간 피어링 생성** 버튼 클릭 합니다.
3. **이름**, **로컬 VPC**, **피어 리전**, **피어 VPC ID** 을 입력 합니다.</br>
   > [참고] 피어 VPC ID<br>
   > **피어 VPC ID** 확인은 하단의 "피어 리전의 VPC ID 확인 가이드" 내용 참고 

### 피어 리전의 VPC ID 확인 가이드
리전간 피어링을 생성하기 위해서는 다른 리전에서 피어링 대상이 되는 VPC의 VPC ID를 알아야합니다. 다음 절차로 피어 리전의 VPC ID를 확인 할 수 있습니다.

1. 피어 리전의 콘솔 화면에 접속
2. **Network > VPC > 관리** 로 이동
3. 피어링 대상 VPC 선택
4. **기본 정보 > VPC 이름** 에 표기된 UUID 값 복사

## 프로젝트 간 피어링

프로젝트 간 피어링은 서로 다른 프로젝트에 생성된 두 개의 VPC를 연결하는 기능입니다. 같은 프로젝트의 VPC는 피어링을 이용하여 연결할 수 있으나 프로젝트가 다른 VPC를 연결할 수는 없습니다. 따라서 프로젝트가 다른 두 개의 VPC를 연결하는 기능을 제공하는데 이를 프로젝트간 간 피어링이라 합니다.

> [참고] 프로젝트 간 피어링은 서로 다른 프로젝트의 두 VPC를 연결합니다. 다른 VPC를 건너서 또 다른 VPC로 연결하는 것은 지원하지 않습니다. A <-> B <-> C 연결에서 A와 C는 연결되지 않습니다.

* 프로젝트간 간 피어링은 한국(평촌) 리전과 한국(판교) 리전의 VPC에서만 이용할 수 있습니다.
* 동일 리전 서로 다른 프로젝트의 두 개의 VPC만 연결이 가능합니다.
* 프로젝트 간 피어링을 생성하면 연결된 다른 프로젝트에서 자동으로 생성됩니다.
* 프로젝트 간 피어링을 삭제하면 연결된 다른 프로젝트에서 자동으로 삭제됩니다.
* 두 VPC의 IP 주소 영역은 겹치면 사용할 수 없습니다.
* 중복된 VPC연결은 생성할 수 없습니다.
* 피어링된 양쪽 VPC의 라우팅 테이블에 별도의 라우트를 설정해야 통신이 가능합니다.
    * 라우트의 **대상 CIDR**에 상대 VPC의 IP 주소 영역을 입력하고, **게이트웨이** 목록에서 프로젝트간 간 피어링의 이름을 갖는 **INTER_PROJECT_PEERING** 항목을 선택해 라우트를 추가합니다.
    * 라우트를 추가한 라우팅 테이블에 연결된 서브넷으로만 통신이 가능합니다.
    * **기본 라우팅 테이블**이 아닌 라우팅 테이블에 라우트를 추가하면 라우팅 테이블에 연결된 서브넷에서 피어링 통신이 가능합니다.
    * 피어링 생성 시 서브넷이 없는 VPC를 지정하면 피어링은 생성에 실패합니다.

### 프로젝트간 간 피어링 생성 가이드
프로젝트 간 피어링을 생성하기 위해서는 피어 프로젝트의 **프로젝트 피어링 허용**에 내 프로젝트의 **테넌트 ID**와 **VPC ID**가 허용 되 있어야 합니다.
프로젝트 간 피어링을 생성하기 전에 앞서 피어 프로젝트의 관리자에게 **테넌트 ID**와 **VPC ID**를 전달하고 **프로젝트 피어링 허용**에 정보 등록 을 요청하여야 합니다.
피어 프로젝트에서 정보등록이 완료되면 다음 절차에 따라서 프로젝트 간 피어링을 생성 할 수 있습니다.
> [참고] **프로젝트 피어링 허용** 사용 방법은 하단의 "프로젝트 피어링 허용 가이드" 내용 참고 
1. **Network > Peering Gateway > 프로젝트 간 피어링** 으로 이동 합니다.
2. **프로젝트간 간 피어링 생성** 버튼을 클릭 합니다.
3. **이름**, **로컬 VPC**, **피어 리전**, **피어 테넌트 ID**, **피어 VPC ID** 을 입력 합니다.</br>
   > [참고] 피어 테넌트 ID, 피어 VPC ID <br>
   > **피어 테넌트 ID** 확인은 하단의 "피어 프로젝트의 피어 테넌트 ID 확인 가이드" 내용 참고 <br>
   > **피어 VPC ID** 확인은 하단의 "피어 프로젝트의 피어 VPC ID 확인 가이드" 내용 참고

### 프로젝트 피어링 허용 가이드
프로젝트 간 피어링 요청을 받는 쪽에서 설정을 합니다. 요청을 보내는 상대방의 Tenant ID와 VPC ID를 입력하여 피어가 보내는 프로젝트 간 피어링 요청을 수락 할 수 있게 합니다.
1. **Network > Peering Gateway > 프로젝트 간 피어링** 으로 이동 합니다.
2. **프로젝트 피어링 허용** 버튼을 클릭 합니다.
3. **이름**, **피어 테넌트 ID**, **피어 VPC** 를 입력하고 확인 버튼을 클릭합니다.

### 피어 프로젝트의 VPC ID 확인 가이드
프로젝트 간 피어링을 생성하기 위해서는 피어 프로젝트에서 피어링 대상이 되는 VPC의 VPC ID를 알아야합니다. 다음 절차로 피어 프로젝트의 VPC ID를 확인 할 수 있습니다.
> [참고] 피어 프로젝트에 접근 권한이 없을시 피어 프로젝트의 관리자에게 VPC ID를 제공받기 바랍니다.

1. 피어 프로젝트의 콘솔 화면에 접속
2. **Network > VPC > 관리** 로 이동
3. 피어링 대상 VPC 선택
4. **기본 정보 > VPC 이름** 에 표기된 UUID 값 복사

### 피어 프로젝트의 테넌트 ID 확인 가이드
프로젝트 간 피어링을 생성하기 위해서는 피어 프로젝트에서 **테넌트 ID**를 알아야합니다. 다음 절차로 피어 프로젝트의 **테넌트 ID**를 확인 할 수 있습니다.
> [참고] 피어 프로젝트에 접근 권한이 없을시 피어 프로젝트의 관리자에게 **테넌트 ID**를 제공받기 바랍니다.

1. 피어 프로젝트의 콘솔 화면에 접속
2. **Network > VPC > 관리** 로 이동
3. 피어링 대상 이나 화면에 표기회는 VPC중 아무거나 1개 선택
4. **기본 정보 > 테넌트 ID** 에 표기된 ID 값 복사
